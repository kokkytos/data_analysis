---
title: "Παλινδρόμηση με πολυωνυμικό μοντέλο 2ης τάξης (Quadratic)"
output: html_notebook
source: "https://www.statology.org/quadratic-regression-r/, Πρόσβαση: 08/05/2022"
---

Το παρακάτω αρχείο περιγράφει την σχέση ανάμεσα στις ώρες εργασίας ανά εβδομάδα και στον βαθμό ευτυχίας (με κλίμακα 0-100).


```{r}
data <- data.frame(hours=c(6, 9, 12, 14, 30, 35, 40, 47, 51, 55, 60),
                   happiness=c(14, 28, 50, 70, 89, 94, 90, 75, 59, 44, 27))
data
```
Αν οπτικοποιήσουμε τα δεδομένα σε ένα διάγραμμα διασπορά (scatterplot) άμεσα γίνεται αντιληπτό ότι η σχέση που
συνδέει τις δύο μεταβλητές είναι μη γραμμική.
```{r}
plot(data$hours, data$happiness, xlab="Ώρες εργασίας", ylab="Βαθμός ευτυχίας")
```
Αυτό άλλωστε επιβεβαιώνεται και από την προσπάθεια προσαρμογής ευθείας ελαχίστων τετραγώνων.

```{r}
linearModel <- lm(happiness ~ hours, data=data)
summary(linearModel)
```
Όπως φαίνεται από τον συντελεστή προσδιορισμο μόνο το 4,46% της μεταβλητότητας του βαθμού ευτυχίας ερμηνεύεται από την μεταβολή των ωρών εργασίας.

Ας δοκιμάσουμε να προσαρμόσουμε μια γραμμή με βάση ένα πολυώνυμο β' βαθμου δηλ. της μορφή y=a+bx+cx^2 μιας και από την καμπύλη φαίνεται η σχέση να περιγράφεται από μια παραβολή.

```{r}
data$hours2 <- data$hours^2
quadraticModel <- lm(happiness ~ hours + hours2, data=data)
summary(quadraticModel)
```
Η προσαρμογή πολυωνυμικού μοντέλου β' βαθμού έχει συντελεστή προσδιορισμού 0,96 (96%). Η τιμή αυτή σημαίνει ότι η μεταβλητότητα του βαθμού ευτυχίας εξηγείται σε μεγάλο βαθμό από τις ώρες εργασίας. 
Το προσαρμοσμένο μοντέλο περιγράφεται από την παρακάτω εξίσωση:
Happiness = -0.10120(hours)2 + 6.74436(hours) -18.25364

Ας προσαρμόσουμε μια γραμμή στα δεδομένα με βάση το πολυωνυμικό μοντέλο β'βαθμού.
```{r}
hourValues <- seq(0, 60, 0.1)
happinessPredict <- predict(quadraticModel,data.frame(hours=hourValues, hours2=hourValues^2))

plot(data$hours, data$happiness)
lines(hourValues, happinessPredict, col='red')
```

Μπορούμε να προβλέψουμε τον βαθμό ευτυχίας με βάση συγκεκριμένες ώρες εργασίας:

```{r}
hours=c(10,20,30,60)
predict(quadraticModel,data.frame(hours=hours, hours2=hours^2))
```

