---
title: "Γραμμική παλινδρόμηση στην R"
output: html_notebook
---


Εισαγωγή απαραίτητων βιβλιοθηκών

```{r}
library(tidyverse)
```

Παρακάτω δίνονται τα δεδομένα για 12 οικογένειες σχετικά με την σχέση ανάμεσα στον αριθμό των παιδιών (x) και στις ώρες (y) που αφιερώνουν οι σύζυγοι σε ότι αφορά τις δουλειές του σπιτιού.

```{r}

df <- data.frame(x=c(1,1,1,1,2,2,3,3,4,4,5,5),
                  y=c(1,2,3,5,3,1,5,0,6,3,7,4))

```

Ας εκτυπώσουμε τα δεδομένα που προαναφέρθηκαν σε διάγραμμα διασποράς (scatterplot):

```{r}
plot(df$x,df$y,  col='blue', pch=21, bg="black", xlab="Αριθμός παιδιών", ylab="Ώρες ανά εβδομάδα")
```
Εκτέλεση της γραμμικής παλινδρόμησης:

```{r}
model <- lm(formula = y ~ x, data=df)
```

Μέσω της απλής εκτύπωσης του μοντέλου μπορούμε να λάβουμε ελάχιστες πληροφορίες για αυτό
```{r}
model
```


Οι εκτιμήτριες της ευθείας παλινδρόμησης ελαχίστων τετραγώνων λαμβάνονται ξεχωριστά ως εξής

```{r}
model$coefficients["x"]

model$coefficients["(Intercept)"]


```

Για να πάρουμε περισσότερες πληροφορίες για ένα μοντέλο τρέχουμε την εντολή summary η οποία δέχεται ως όρισμα το μοντέλο.
```{r}
summary(model)
```

Προβολή της ευθείας ελαχίστων τετραγώνων στο διάγραμμα διασποράς:

```{r}

plot(df$x,df$y,  col='black', pch=21, bg="blue", xlab="Αριθμός παιδιών", ylab="Ώρες ανά εβδομάδα")

abline(model)
```

Σε κάθε τιμή του X δεν αντιστοιχεί μία μόνο τιμή Y αλλά πολλές (στοχαστική εξάρτηση).
Αυτές οι τιμές Υ για κάθε τιμή Χ έχουν δική του κατανομή με μέσο όρο και τυπική απόκλιση.
Ας προβάλουμε το μέσο όρο τους ανά τιμή Χ αφού πρώτα τον υπολογίσουμε

```{r}
df_means <- df %>% group_by(x) %>% summarize(meanY=mean(y))
df_means
```



```{r}


plot(df$x,df$y,  col='black', pch=21, bg="blue", xlab="Αριθμός παιδιών", ylab="Ώρες ανά εβδομάδα")

abline(model)
points(df_means$x, df_means$meanY, col='red', pch=13, bg="red")
points(mean(df$x), mean(df$y), pch=8, col='black')
```
Ερμηνεία της ευθείας γραμμικής παλινδρόμησης y=a+bx.

Όπως είδαμε ο συντελεστής παλινδρόμησης είναι σχεδόν 0.69 ώρες. Αυτό σημαίνει ότι για κάθε πρόσθετο παιδί σε μια οικογένεια αυξάνεται ο χρόνος που αφιερώνει ο σύζυγος στις δουλειες του σπιτιού κατά 0.69 ώρες.
Ο συντελεστής α δηλαδή εκεί που τέμνει η ευθεία τον άξονα y δηλαδή για x=0 τότε y=1.5 ώρες. Δηλαδή όταν στην οικογένεια δεν υπάρχουν παιδιά ο σύζυγος αφιερώνει 1.5 ώρα στις δουλειες του σπιτιού.


Πρόβλεψη.

´Εστω ότι σε μια οικογένεια υπάρχουν 6 παιδιά. Πόσες ώρες αναμένεται να αφιερώσει ο σύζυγος στις δουλείες του σπιτιού;
```{r}

predict(model, data.frame(x = 6))
```
Οπότε για 6 παιδιά στην οικογένεια ο σύζυγος προβλέπεται να ασχοληθεί 5,62 ώρες με τις δουλειές του σπιτιού.

Υπολογισμός του συντελεστή συσχέτισης Pearson

```{r}
cor(df$x, df$y, method="pearson")
```
Προκύπτει ότι ανάμεσα στον αριθμό των παιδιών και των ωρών που αφιερώνουν οι σύζυγοι για τις εργασίες στο σπίτι υπάρχει μέση θετική γραμμική συσχέτιση.
