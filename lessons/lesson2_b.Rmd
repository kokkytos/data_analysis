---
title: "Έλεγχοι υποθέσεων"
output: html_notebook
---

Στόχος του τρέχοντος script είναι να επιδείξει πως εκτελείται ένας έλεγχος υπόθεσεων µε την κατανοµή t μέσω της R.
Θα χρησιμοποιήσουμε το Student's t-Test μέσω του οποίου ελέγχεται αν ο μέσος όρος ενός πληθυσμού (μ) είναι διαφορετικός από μία συγκεκριμένη τιμή.

Από ένα ιατρικό αρχείο δεδομένων από δειγματοληψία 55 ατόμων διατίθενται δεδομένα για τρείς μεταβλητές.
Το αρχείο είναι σε μορφή CSV.
Μας ενδιαφέρει η μεταβλητή mmhg.

Ας δοκιμάσουμε να διαβάσουμε το αρχείο στην R και να δούμε μερικές εγγραφές.
Θα ονομάσουμε blood_pressure την μεταβλητή που θα αναφέρεται σε αυτό το αρχείο στην R.

```{r}
blood_pressure <- read.csv("./data/blood_pressure.txt")
head(blood_pressure)
```

Ερώτημα - Διατύπωση υποθέσεων:

Θέλουμε να δοκιμάσουμε αν η μέση αρτηριακή πίεση των ατόμων είναι διαφορετική από το 140 mmHg σε ένα επίπεδο σημαντικότητας α=5%.
Σε αυτήν την περίπτωση διατυπώνουμε:
 - την μηδενική υπόθεσης H0:  η μέση αρτηριακή πίεση δεν είναι διαφορετική από 140mmHg (H0∶ μ = 140)
 - την εναλλακτική υπόθεση H1: η μέση αρτηριακή πίεση είναι διαφορετική από 140mmHg  (H1∶ μ ≠ 140)

Άρα ο έλεγχος που θα κάνουμε θα είναι δίπλευρος.


Επειδή δεν γνωρίζουμε τίποτα για την τυπική απόκλιση του πληθυσμού και το δείγμα είναι μικρό (Ν<100) θα χρησιμοποιήσουμε το
t στατιστικό τέστ.


Για να αντλήσουμε βοήθεια και να δούμε περισσότερες λεπτομέρειες για την σχετική συνάρτηση (t-test) στην R δίνουμε την εντολή: 
```{r}
?t.test

```

 
Στην παρακάτω γραμμή κώδικα καλούμε την σχετική συνάρτηση για τον έλεγχο t-test.
Ορίζουμε σαν παράμετρο της συνάρτησης την μεταβλητή που θέλουμε να ελέγξουμε (mmhg) έναντι της τιμής (140mmHg) του αριθμητικού μέσου που θέλουμε να ελέγξουμε με βάση την μηδενική υπόθεση που διατυπώσαμε.
Επίσης ορίζουμε το επίπεδο εμπιστοσύνης 95% (1-επίπεδο σημαντικότητας) και ότι η εναλλακτική υπόθεση θα είναι δίπλευρη καθότι H1∶ μ ≠ 140

```{r}
t.test(blood_pressure$mmhg,mu=140,conf.level = 0.95, alternative = "two.sided")

```

Η μηδενική υπόθεση απορρίπτεται δεδομένου ότι p=0.0002961  (p<=0.05) η μηδενική υπόθεση απορρίπτεται καθώς υπάρχει αυστηρή απόδειξη εναντίον της. 
Ωστόσο υπάρχουν και άλλα κριτήρια που απορρίπτεται η μηδενική υπόθεση (t-value).
Όπως βλέπουμε η τιμή t-value=-3.8693. 
Πάμε να υπολογίσουμε τα όρια της κριτικής περιοχής με βάση την κατανομή t σε επίπεδο σημαντικότητας α=0.05 και N-1 (55-1=54) βαθμούς ελευθερίας:

```{r}
qt(p=0.025, df =54)
```
Οριζουμε σαν πιθανοτα p=0.05/2 μιας και ο ελεγχος ειναι διπλευρος και φυσικα τους βαθμους ελευθεριας df=55-1.
Τα κρίσιμα όρια Τ-critical = ±2.004879. 
Όπως φαίνεται t-value < Τ-critical (-3.8693 < -2.004879) και με βάση αυτό απορρίπτεται η μηδενική υπόθεση Ηο. 


Ερμηνεία:

Άρα έχουμε στατιστικά σημαντικό αποτέλεσμα ότι η μέση αρτηριακή πίεση του δείγματος προέρχεται από πληθυσμό ασθενών με μέση αρτηριακή πίεση διαφορετική από 140mmHg. 






Βιβλιογραφία:

Taeger, D., Kuhnt, S., 2014. Statistical hypothesis testing with SAS and R. Wiley, Chichester, West Sussex.
