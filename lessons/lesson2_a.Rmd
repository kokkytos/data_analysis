---
title: "Έλεγχος υποθέσεων του μέσου αριθμητικού"
output: html_notebook
---

Στην τρέχουσα ενότητα/άσκηση ασχολούμαστε με το ερώτημα, αν ο μέσος ενός κανονικού πληθυσμού
διαφέρει από μια προκαθορισμένη τιμή.
Αν είναι γνωστή ή όχι η διακύμανση της κατανομής του πληθυσμού θα καθορίσει και το είδος του τεστ (z-test ή t-test)
Οι βασικές υποθέσεις που γίνονται είναι ότι
- τα δεδομένα μετριούνται σε κλίμακα διαστήματος ή λόγου.
- δείγμα είναι τυχαίο από μια κανονική κατανομή.
- η τυπική απόκλιση (σ) της κατανομή είναι γνωστή.


# Πρόβλημα
Κατά τα τελευταία τρία χρόνια σε μια περιφέρεια αναφέρεται ότι τα περιστατικά των ατυχημάτων φορτηγών 
είναι 0.5 συγκρούσεων ανά 1 εκατ. οχηματοχιλιόμετρα και με τυπική απόκλιση 0.1
Στα πλαίσια του περιορισμού αυτών των ατυχημάτων επιβλήθηκε στους οδηγούς φορτηγών να παρακαλουθήσουν
συμπληρωματικά ένα πρόγραμμα μαθήματων οδήγησης για την ασφαλειά τους.
Μετά το πέρας του προγράμματος μετρήθηκαν δειγματοληπτικά σε 50 τμήματα του οδικού δικτύου ο αριθμός των συγκρούσεων.
Ζητείται να διαπιστωθεί κατά πόσο το πρόγραμμα αυτό συνέβαλε στον περιορισμό των συγκρούσεων

Παρακάτω δίνεται ο αριθμός των συγκρούσεων/εκατ.vkm
```{r}
df <- c(0.3, 0.91, 0.69, 0.57, 0.28, 0.86, 0.68, 0.36, 0.83, 0.88, 
0.76, 0.85, 1.05, 0.7, 0.83, 0.76, 0.51, 0.6, 0.8, 0.71, 1.24, 
1.09, 0.23, 0.67, 0.97, 0.97, 0.37, 0.31, 0.76, 0.63, 0.91, 0.97, 
0.4, 0.59, 1.05, 0.57, 0.12, 0.69, 0.86, 0.7, 0.6, 0.69, 0.51, 
0.72, 1.27, 0.82, 0.43, 0.86, 0.32, 0.83)

df <- data.frame(df)
colnames(df) <- "CrashRate"
df
```
Ας δούμε την κατανομή των δεδομένων:

```{r}
hist(df$CrashRate)
plot(density(df$CrashRate)) # plots the results
```
Η κατανομή προσομοιάζει το σχήμα καμπάνας (κανονική κατανομή).
Από τα δεδομένα έχουμε:

```{r}
mean_pop <- 0.5 # μέσο όρο πληθυσμού
sd_pop <- 0.1 #τυπική απόκλιση πληθυσμού
mean_sample <- mean(df$CrashRate) # 0.7016
sd_sample <-sd(df$CrashRate) # 0.2579619
N <- length(df$CrashRate) # 50
```
Αρχικά η πρώτη διαπίστωση που θα μπορούσε να κάνει κάποιος είναι ότι το πρόγραμμα αντί να μειώσει τα περιστατικά 
συγκρούσεων αντιθέτως τα αύξησε (μιας και έχει mean 0.7016 έναντι 0.5).
Ωστόσο μια τέτοια διαπίστωση είναι βεβιασμένη γιατί ο μέσος όρος για το πρόγραμμα προέκυψε από δειγματοληψία γεγονός που δεν αντιπροσωπέυει πλήρως την πραγματική εικόνα του πληθυσμού καθότι περιέχει μέσα το δειγματοληπτικό σφάλμα. Οπότε ο αναλυτής προσφεύγει στην ανάλυση υποθέσεων για να διαπιστώσει την επίπτωση του προγράμματος στον ρυθμό συγκρούσεων.

Βήμα 1.
Η διατύπωση των υποθέσεων είναι ως εξής:
Ho: μ = 0.5, μηδενική υπόθεση. Ότι ο ρυθμός των ατυχημάτων μετά το εκπαιδευτικό πρόγραμμα δεν διαφέρει από τον μέσο όρο 0.5 που ίσχυει γενικά για τα ατυχήματα τα τελευταία τρια χρόνια.
HA: μ ≠ 0.5 εναλλακτική υπόθεση. Ο ρυθμός των ατυχημάτων μετά το εκπαιδευτικό πρόγραμμα διαφέρει από τον μέσο όρο 0.5 που ίσχυει γενικά για τα ατυχήματα τα τελευταία τρια χρόνια.

Ό έλεγχος είναι δίπλευρος γιατί δεν κάνουμε κάποια εικασία για την φορά της μεταβολής, αν δηλαδή οι συγκρούσεις αυξήθηκαν ή μειώθηκαν.

Βήμα 2.
Ο έλεγχος υποθέσεων θα γίνει στο Επίπεδο σημαντικότητας:
α=0.05.
```{r}
alpha <- 0.05
```
Υπολογίζουμε τα όρια της περιοχής αποδοχής και απόρριψης (Z critical) για α=0.05
```{r}
Z.critical <- qnorm(1-(0.05/2))

Z.critical
```
Οποιαδήποτε τιμή πέρα από τα όρια ± 1.96 θεωρείται σπάνιο γεγονός και οδηγεί στην απόρριψη της μηδενικής υπόθεσης H0.



Βήμα 3.
Υπολογίζουμε την τιμή του στατιστικού τεστ.
```{r}
z_obtained<-(mean_sample-mean_pop)/(sd_pop/sqrt(N))
z_obtained
```
Συμπέρασμα:
Η μηδενική υπόθεση Ho απορρίπτεται στο επίπεδο σημαντικότητας α=0.05 δεδομένου ότι το z_obtained>z_critical.
Οπότε απορρίπτεται η εικασία ότι ο ρυθμός των ατυχημάτων μετά το εκπαιδευτικό πρόγραμμα δεν διαφέρει από τον μέσο όρο 0.5 που ίσχυει γενικά για τα ατυχήματα τα τελευταία τρια χρόνια. Άρα αυτό σημαίνει ότι κατόπιν της εφαρμογής του προγράμματος υπήρχε επίπτωση στον αριθμό των συγκρούσεων.
Όμως το παραπάνω απαντά στο ερώτημα αν υπάρχει διαφορά και όχι αν υπάρχει μείωση ή αύξηση.
Για να απαντηθεί το ερώτημα αν υπήρχε αύξηση στις συγκρούσης κατόπιν της εφαρμογής του προγράμματος πρέπει να γίνει μονόπλευρος έλεγχος με υποθέσεις εργασίας:
Ho: μ ≤ 0.5,
HΑ: μ > 0.5

Σε αυτήν την περίπτωση προσέχουμε ότι το όριο της περιοχής απόρριψης ορίζεται μονόπλευρα και είναι πιο κοντά στον μέσο όρο δηλ. 1.64 βλέπε υπολογισμό παρακάτω


```{r}
Z.critical <- qnorm(0.05, lower.tail = F)
```






