---
title: "Γραμμική παλινδρόμηση στην R"
output: html_notebook
---


Κατά την μελέτη της αλληλεξάρτησης δύο μεταβλητών Χ και Υ παρατηρήθηκαν τα παρακάτω ζεύγη τιμών.

```{r}

df <- data.frame(x=c(0,1,2,3,4),
                  y=c(1,3,7,12,17))
df

n=nrow(df)


```

Ας εκτυπώσουμε τα δεδομένα που προαναφέρθηκαν σε διάγραμμα διασποράς (scatterplot):

```{r}
plot(df$x,df$y,  col='blue', pch=21, bg="black", xlab="Αριθμός παιδιών", ylab="Ώρες ανά εβδομάδα")
```
Εκτέλεση της γραμμικής παλινδρόμησης:

```{r}
model <- lm(formula = y ~ x, data=df)
```

Μέσω της απλής εκτύπωσης του μοντέλου μπορούμε να λάβουμε ελάχιστες πληροφορίες για αυτό
```{r}
model
```


Οι εκτιμήτριες της ευθείας παλινδρόμησης ελαχίστων τετραγώνων λαμβάνονται ξεχωριστά ως εξής

```{r}
b=model$coefficients["x"]
a=model$coefficients["(Intercept)"] 

print(sprintf("Η τιμή της παραμέτρου β είναι: %s και της παραμέτρου α είναι: %s", as.vector(b),round(as.vector(a),2)))


```

Για να πάρουμε περισσότερες πληροφορίες για ένα μοντέλο τρέχουμε την εντολή summary η οποία δέχεται ως όρισμα το μοντέλο.
```{r}
summary(model)
```
Ας δούμε ποιες τιμές έχουν εκτιμηθεί με βάση το μοντέλο 

```{r}
predict(model)
```
Προβολή διαγράμματος κατάλοιπων
```{r}
plot(model, pch=16, which=1)
```




Μπορούμε να υπολογίσουμε το μέσο τετραγωνικό σφάλμα (με βάση τον σχετικό τύπο):
```{r}
sum((df$y - predict(model))^2)/n

# ή
# sum(model$residuals^2)/n



```

Ή εναλλακτικά με την συνάρτηση mse() από την βιβλιοθήκη Metrics (απαιτείται εγκατάσταση).

```{r}
library(Metrics)
mse(df$y, predict(model))
```
To μέσο τετραγωνικό σφάλμα είναι μη συγκρίσιμο μέγεθος και δίνεται σε τετραγωνικές μονάδες μέτρησης της μεταβλητής y.

Ο δείκτης προσδιορισμού αποτυπώνει καλύτερα την σχέση των δύο μεταβλητών και την ερμηνεία της μεταβλητικότητας της Y από την σχέση της με την Χ.
Ο δείκτης προσδιορισμού ρ2 έχει υπολογιστεί ήδη στην R και για να τον εξάγουμε από το μοντέλο τρέχουμε:
```{r}
summary(model)$r.squared
```
Το παραπάνω σημαίνει ότι σχεδόν το 98% της μεταβλητικότητας της Υ ερμηνεύεται από την επίδραση από την σχέση της με την Χ. Το υπόλοιπο 2% της μεταβλητικότητας της Υ εξαρτάται από άλλους παράγοντες. 


Προβολή της ευθείας ελαχίστων τετραγώνων στο διάγραμμα διασποράς:

```{r}

plot(df$x,df$y,  col='black', pch=21, bg="blue", xlab="Αριθμός παιδιών", ylab="Ώρες ανά εβδομάδα")

abline(model)
```

Ερμηνεία της ευθείας γραμμικής παλινδρόμησης y=a+bx.

Όπως είδαμε ο συντελεστής παλινδρόμησης είναι σχεδόν 4,1. Αυτό σημαίνει ότι για κάθε πρόσθετη μονάδα Χ αυξάνεται  κατά 4,1 μονάδες η  Υ.
Ο συντελεστής α δηλαδή εκεί που τέμνει η ευθεία τον άξονα y δηλαδή για x=0 τότε y=-0,2 ώρες. 




Υπολογισμός του συντελεστή συσχέτισης Pearson
```{r}
cor(df$x, df$y, method="pearson")
```
Υπάρχει ισχυρή θετική συσχέτιση ανάμεσα στις δύο μεταβλητές. Όπως αναφέρθηκε συσχέτιση δεν σημαίνει απαραίτητα και αιτιότητα.
